(function(t){function e(e){for(var s,r,o=e[0],h=e[1],c=e[2],l=0,f=[];l<o.length;l++)r=o[l],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&f.push(i[r][0]),i[r]=0;for(s in h)Object.prototype.hasOwnProperty.call(h,s)&&(t[s]=h[s]);u&&u(e);while(f.length)f.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],s=!0,o=1;o<n.length;o++){var h=n[o];0!==i[h]&&(s=!1)}s&&(a.splice(e--,1),t=r(r.s=n[0]))}return t}var s={},i={app:0},a=[];function r(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=s,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(n,s,function(e){return t[e]}.bind(null,s));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/vue-signatures/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],h=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var u=h;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";n("85ec")},"1a54":function(t,e,n){"use strict";n("7e32")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var s=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"sign",staticStyle:{position:"relative"}},[n("div",{staticClass:"box-esign"},[n("autoFullScreen",{ref:"esign",attrs:{width:t.width,height:t.height,isCrop:t.isCrop,lineWidth:t.lineWidth,lineColor:t.lineColor,bgColor:t.bgColor}})],1),t.fullStatus?t._e():n("div",{staticClass:"button-sign"},[n("el-button",{attrs:{type:"danger",size:"small"},on:{click:t.handleReset}},[t._v("清除")]),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.handleGenerate}},[t._v("保存")])],1),t.fullStatus?n("div",{staticClass:"button-sign-full"},[n("el-button",{attrs:{type:"danger",size:"small"},on:{click:t.handleReset}},[t._v("清除")]),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.handleGenerate}},[t._v("保存")])],1):t._e()])},a=[],r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("canvas",{ref:"canvas",attrs:{id:"myCanvas"},on:{mousedown:t.mouseDown,mousemove:t.mouseMove,mouseup:t.mouseUp,touchstart:t.touchStart,touchmove:t.touchMove,touchend:t.touchEnd}})},o=[],h=n("2909"),c=(n("a9e3"),n("d3b7"),{props:{width:{type:Number,default:800},height:{type:Number,default:300},lineWidth:{type:Number,default:4},lineColor:{type:String,default:"#000000"},bgColor:{type:String,default:""},isCrop:{type:Boolean,default:!1}},data:function(){return{hasDrew:!1,resultImg:"",points:[],canvasTxt:null,startX:0,startY:0,isDrawing:!1,sratio:1}},computed:{ratio:function(){return this.height/this.width},stageInfo:function(){return this.$refs.canvas.getBoundingClientRect()},myBg:function(){return this.bgColor?this.bgColor:"rgba(255, 255, 255, 0)"}},watch:{myBg:function(t){this.$refs.canvas.style.background=t},width:function(){this.$_resizeHandler()}},mounted:function(){var t=this,e=this.$refs.canvas;e.width=this.width,e.height=this.height,e.style.background=this.myBg,this.canvasTxt=e.getContext("2d"),document.onmouseup=function(){t.isDrawing=!1}},methods:{$_resizeHandler:function(){var t=this.$refs.canvas,e=this.canvasTxt.getImageData(0,0,t.width,t.height);t.width=this.width,t.height=this.height,this.canvasTxt.putImageData(e,0,0)},mouseDown:function(t){t=t||event,t.preventDefault(),this.isDrawing=!0,this.hasDrew=!0;var e={x:t.offsetX,y:t.offsetY};this.drawStart(e)},mouseMove:function(t){if(t=t||event,t.preventDefault(),this.isDrawing){var e={x:t.offsetX,y:t.offsetY};this.drawMove(e)}},mouseUp:function(t){t=t||event,t.preventDefault();var e={x:t.offsetX,y:t.offsetY};this.drawEnd(e),this.isDrawing=!1},touchStart:function(t){if(t=t||event,t.preventDefault(),this.hasDrew=!0,1===t.touches.length){var e={x:t.targetTouches[0].clientX-this.$refs.canvas.getBoundingClientRect().left,y:t.targetTouches[0].clientY-this.$refs.canvas.getBoundingClientRect().top};this.drawStart(e)}},touchMove:function(t){if(t=t||event,t.preventDefault(),1===t.touches.length){var e={x:t.targetTouches[0].clientX-this.$refs.canvas.getBoundingClientRect().left,y:t.targetTouches[0].clientY-this.$refs.canvas.getBoundingClientRect().top};this.drawMove(e)}},touchEnd:function(t){if(t=t||event,t.preventDefault(),1===t.touches.length){var e={x:t.targetTouches[0].clientX-this.$refs.canvas.getBoundingClientRect().left,y:t.targetTouches[0].clientY-this.$refs.canvas.getBoundingClientRect().top};this.drawEnd(e)}},drawStart:function(t){this.startX=t.x,this.startY=t.y,this.canvasTxt.beginPath(),this.canvasTxt.moveTo(this.startX,this.startY),this.canvasTxt.lineTo(t.x,t.y),this.canvasTxt.lineCap="round",this.canvasTxt.lineJoin="round",this.canvasTxt.lineWidth=this.lineWidth*this.sratio,this.canvasTxt.stroke(),this.canvasTxt.closePath(),this.points.push(t)},drawMove:function(t){this.canvasTxt.beginPath(),this.canvasTxt.moveTo(this.startX,this.startY),this.canvasTxt.lineTo(t.x,t.y),this.canvasTxt.strokeStyle=this.lineColor,this.canvasTxt.lineWidth=this.lineWidth*this.sratio,this.canvasTxt.lineCap="round",this.canvasTxt.lineJoin="round",this.canvasTxt.stroke(),this.canvasTxt.closePath(),this.startY=t.y,this.startX=t.x,this.points.push(t)},drawEnd:function(t){this.canvasTxt.beginPath(),this.canvasTxt.moveTo(this.startX,this.startY),this.canvasTxt.lineTo(t.x,t.y),this.canvasTxt.lineCap="round",this.canvasTxt.lineJoin="round",this.canvasTxt.stroke(),this.canvasTxt.closePath(),this.points.push(t),this.points.push({x:-1,y:-1})},generate:function(){var t=this,e=new Promise((function(e,n){if(t.hasDrew){var s=t.canvasTxt.getImageData(0,0,t.$refs.canvas.width,t.$refs.canvas.height);t.canvasTxt.globalCompositeOperation="destination-over",t.canvasTxt.fillStyle=t.myBg,t.canvasTxt.fillRect(0,0,t.$refs.canvas.width,t.$refs.canvas.height),t.resultImg=t.$refs.canvas.toDataURL();var i=t.resultImg;if(t.canvasTxt.clearRect(0,0,t.$refs.canvas.width,t.$refs.canvas.height),t.canvasTxt.putImageData(s,0,0),t.canvasTxt.globalCompositeOperation="source-over",t.isCrop){var a,r=t.getCropArea(s.data),o=document.createElement("canvas"),c=o.getContext("2d");o.width=r[2]-r[0],o.height=r[3]-r[1];var u=(a=t.canvasTxt).getImageData.apply(a,Object(h["a"])(r));c.globalCompositeOperation="destination-over",c.putImageData(u,0,0),c.fillStyle=t.myBg,c.fillRect(0,0,o.width,o.height),i=o.toDataURL(),o=null}e(i)}else n("画板内容为空!")}));return e},reset:function(){this.canvasTxt.clearRect(0,0,this.$refs.canvas.width,this.$refs.canvas.height),this.$emit("update:bgColor",""),this.$refs.canvas.style.background="rgba(255, 255, 255, 0)",this.points=[],this.hasDrew=!1,this.resultImg=""},getCropArea:function(t){for(var e=this.$refs.canvas.width,n=0,s=this.$refs.canvas.height,i=0,a=0;a<this.$refs.canvas.width;a++)for(var r=0;r<this.$refs.canvas.height;r++){var o=4*(a+this.$refs.canvas.width*r);(t[o]>0||t[o+1]>0||t[o+2]||t[o+3]>0)&&(i=Math.max(r,i),n=Math.max(a,n),s=Math.min(r,s),e=Math.min(a,e))}e++,n++,s++,i++;var h=[e,s,n,i];return h}}}),u=c,l=(n("1a54"),n("2877")),f=Object(l["a"])(u,r,o,!1,null,"5e6d5bb6",null),v=f.exports,d={components:{autoFullScreen:v},data:function(){return{lineWidth:6,lineColor:"#000000",bgColor:"",resultImg:"",isCrop:!0,width:800,height:300,fullStatus:!1}},mounted:function(){var t=this;this.$nextTick((function(){t.renderResize()})),window.addEventListener("resize",this.renderResize,!1)},beforeDestroy:function(){window.removeEventListener("resize",this.renderResize,!1)},methods:{renderResize:function(){var t=document.documentElement.clientWidth,e=document.documentElement.clientHeight;t>e?(this.width=t-5,this.height=e-10,this.fullStatus=!0):(this.width=t,this.height=300,this.fullStatus=!1)},handleReset:function(){this.$refs.esign.reset()},handleGenerate:function(){var t=this;this.$refs.esign.generate().then((function(e){console.log(e),t.resultImg=e})).catch((function(e){t.$message.warning(e)}))}}},g=d,p=(n("034f"),Object(l["a"])(g,i,a,!1,null,null,null)),m=p.exports,x=n("5c96"),w=n.n(x);n("0fae");s["default"].config.productionTip=!1,s["default"].use(w.a),new s["default"]({render:function(t){return t(m)}}).$mount("#app")},"7e32":function(t,e,n){},"85ec":function(t,e,n){}});
//# sourceMappingURL=app.e623a96e.js.map